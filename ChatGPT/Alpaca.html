
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Hello, Alpaca? &#8212; NLP Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=4ec06e9971c5264fbd345897d5258098f11cc577" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=8bf782fb4ee92b3d3646425e50f299c4e1fd152d"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-RCPD8XLR5D"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-RCPD8XLR5D');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ChatGPT/Alpaca';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction" href="PEFT.html" />
    <link rel="prev" title="Introduction" href="introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../intro.html">

  
  
  
  
  
  
  

  
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Setup/setup.html">
                        Setup
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../NLP/nlp.html">
                        Natural Language Processing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../BasicNLP/overview/overview.html">
                        Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../BasicNLP/text_representation/text_representation.html">
                        Text Representation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../BasicNLP/dl_nlp/dl_nlp.html">
                        Deep Learning for NLP
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../BasicNLP/LM/LM.html">
                        Language Model
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Transformer/architecture/introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Transformer/architecture/transformer_family.html">
                        Transformer Family
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../TransformerModels/introduction.html">
                        Transformer models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Exercise/introduction.html">
                        Downstream Task
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Exercise/sentiment_analysis.html">
                        ê°ì„±ë¶„ì„ (Sentiment Analysis)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Exercise/Making_Transformers_Efficient_in_Production.html">
                        Making Transformers Efficient in Production
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Exercise/Training_Transformers_from_Scratch.html">
                        Training Transformers from Scratch
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../LLM/introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../LLM/slurm.html">
                        SLURM
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Hello, Alpaca?
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="PEFT.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../DevChatGPT/introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/appendix.html">
                        Appendix
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/DeepLearningMath/calculus.html">
                        ë¯¸ë¶„ê³¼ ê·¸ë˜ë””ì–¸íŠ¸
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/DeepLearningMath/MLE.html">
                        MLE (Maximum Likelihood Estimation)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/DeepLearningMath/MAP.html">
                        MAP (Maximum A P Posteriori Estimation)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/DeepLearningMath/naiveBayesClassifier.html">
                        Naive Bayes Classifier
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/Entropy/informationEntropy.html">
                        ì •ë³´ì™€ ì—”íŠ¸ë¡œí”¼
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/Entropy/jointConditionalEntropy.html">
                        Joint Entropyì™€ Conditional Entropy
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/Entropy/crossEntropyKLDivergence.html">
                        Mutual Information, Cross Entropy ê·¸ë¦¬ê³  KL Divergenceê¹Œì§€
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Setup/setup.html">
                        Setup
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../NLP/nlp.html">
                        Natural Language Processing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../BasicNLP/overview/overview.html">
                        Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../BasicNLP/text_representation/text_representation.html">
                        Text Representation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../BasicNLP/dl_nlp/dl_nlp.html">
                        Deep Learning for NLP
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../BasicNLP/LM/LM.html">
                        Language Model
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Transformer/architecture/introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Transformer/architecture/transformer_family.html">
                        Transformer Family
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../TransformerModels/introduction.html">
                        Transformer models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Exercise/introduction.html">
                        Downstream Task
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Exercise/sentiment_analysis.html">
                        ê°ì„±ë¶„ì„ (Sentiment Analysis)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Exercise/Making_Transformers_Efficient_in_Production.html">
                        Making Transformers Efficient in Production
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Exercise/Training_Transformers_from_Scratch.html">
                        Training Transformers from Scratch
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../LLM/introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../LLM/slurm.html">
                        SLURM
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Hello, Alpaca?
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="PEFT.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../DevChatGPT/introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/appendix.html">
                        Appendix
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/DeepLearningMath/calculus.html">
                        ë¯¸ë¶„ê³¼ ê·¸ë˜ë””ì–¸íŠ¸
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/DeepLearningMath/MLE.html">
                        MLE (Maximum Likelihood Estimation)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/DeepLearningMath/MAP.html">
                        MAP (Maximum A P Posteriori Estimation)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/DeepLearningMath/naiveBayesClassifier.html">
                        Naive Bayes Classifier
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/Entropy/informationEntropy.html">
                        ì •ë³´ì™€ ì—”íŠ¸ë¡œí”¼
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/Entropy/jointConditionalEntropy.html">
                        Joint Entropyì™€ Conditional Entropy
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../Appendix/Entropy/crossEntropyKLDivergence.html">
                        Mutual Information, Cross Entropy ê·¸ë¦¬ê³  KL Divergenceê¹Œì§€
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">
  


<a class="navbar-brand logo" href="../intro.html">

  
  
  
  
  
  
  

  
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    </div>
    <div class="sidebar-start-items__item">
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    ë“¤ì–´ê°€ë©°
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">1ì¥ SetUp</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Setup/setup.html">Setup</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Setup/setup_env.html">íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° í™˜ê²½ì„¤ì •</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../NLP/nlp.html">Natural Language Processing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">2ì¥ BasicNLP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../BasicNLP/overview/overview.html">Overview</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/overview/%ED%95%9C%EA%B8%80%EA%B3%BC%EC%9E%90%EC%97%B0%EC%96%B4%EC%B2%98%EB%A6%AC.html">í•œêµ­ì–´ì™€ ìì—°ì–´ì²˜ë¦¬</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/overview/%EC%9E%90%EC%97%B0%EC%96%B4%EC%B2%98%EB%A6%AC%EC%9A%A9%EC%96%B4.html">token, sentence, vector spaces, embedding</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../BasicNLP/text_representation/text_representation.html">Text Representation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/text_representation/tf-idf.html">TF-IDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/text_representation/word2vec.html">Word2Vec &amp; GloVe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/text_representation/contextual_word_representation.html">Contextual word representation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../BasicNLP/dl_nlp/dl_nlp.html">Deep Learning for NLP</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/dl_nlp/mlp.html">MLP(Multi-Layer Perceptron)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/dl_nlp/cnn.html">CNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/dl_nlp/rnn.html">RNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/dl_nlp/attention_mechanism.html">Attention mechanism</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../BasicNLP/LM/LM.html">Language Model</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/LM/probability.html">Probability Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BasicNLP/LM/disc_gen_model.html">Discriminative VS Generative model</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">3ì¥ Transformer</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Transformer/architecture/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Transformer/architecture/transformer_family.html">Transformer Family</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../TransformerModels/introduction.html">Transformer models</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../TransformerModels/transformers.html">Transformersë¡œ ë­˜ í•  ìˆ˜ ìˆì„ê¹Œìš”?</a></li>









<li class="toctree-l2"><a class="reference internal" href="../TransformerModels/transformers%EC%82%AC%EC%9A%A9%EB%B2%95.html">Transformer ì‚¬ìš©ë²•</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TransformerModels/%EB%8B%A4%EC%96%91%ED%95%9C%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8.html">ì–¸ì–´ëª¨ë¸ì˜ ë‹¤ì–‘í•œ ì•„í‚¤í…ì³</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TransformerModels/bias_and_limitations.html">ì–¸ì–´ëª¨ë¸ì˜ í¸ê²¬ ë° í•œê³„</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TransformerModels/%EB%A7%BA%EC%9C%BC%EB%A9%B0.html">ë§ºìœ¼ë©°</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TransformerModels/%ED%80%B4%EC%A6%88.html">ì±•í„° ë í€´ì¦ˆ</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">4ì¥ Downstream Task</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Exercise/introduction.html">Downstream Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Exercise/sentiment_analysis.html">ê°ì„±ë¶„ì„ (Sentiment Analysis)</a></li>









<li class="toctree-l1"><a class="reference internal" href="../Exercise/Making_Transformers_Efficient_in_Production.html">Making Transformers Efficient in Production</a></li>






<li class="toctree-l1"><a class="reference internal" href="../Exercise/Training_Transformers_from_Scratch.html">Training Transformers from Scratch</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">5ì¥ Large Language Models(LLMs)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../LLM/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LLM/slurm.html">SLURM</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">6ì¥ ChatGPT</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hello, Alpaca?</a></li>



<li class="toctree-l1"><a class="reference internal" href="PEFT.html">Introduction</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">7ì¥ ë‚˜ë§Œì˜ ChatGPT ë§Œë“¤ê¸°</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../DevChatGPT/introduction.html">Introduction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ë¶€ë¡</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Appendix/appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/DeepLearningMath/calculus.html">ë¯¸ë¶„ê³¼ ê·¸ë˜ë””ì–¸íŠ¸</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/DeepLearningMath/MLE.html">MLE (Maximum Likelihood Estimation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/DeepLearningMath/MAP.html">MAP (Maximum A P Posteriori Estimation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/DeepLearningMath/naiveBayesClassifier.html">Naive Bayes Classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/Entropy/informationEntropy.html">ì •ë³´ì™€ ì—”íŠ¸ë¡œí”¼</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/Entropy/jointConditionalEntropy.html">Joint Entropyì™€ Conditional Entropy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/Entropy/crossEntropyKLDivergence.html">Mutual Information, Cross Entropy ê·¸ë¦¬ê³  KL Divergenceê¹Œì§€</a></li>


</ul>

    </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        <label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" data-toggle="tooltip" data-placement="right" title="Toggle primary sidebar">
            <span class="fa-solid fa-bars"></span>
        </label>
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="btn btn-sm"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<div class="dropdown dropdown-repository-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      <li><a href="https://github.com/eagle705/nlp-book" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">repository</span>
</a>
</a>
      
      <li><a href="https://github.com/eagle705/nlp-book/issues/new?title=Issue%20on%20page%20%2FChatGPT/Alpaca.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">open issue</span>
</a>
</a>
      
  </ul>
</div>



<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      <li><a href="../_sources/ChatGPT/Alpaca.md" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</a>
      
      <li>
<button onclick="printPdf(this)"
  class="btn btn-sm dropdown-item"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</a>
      
  </ul>
</div>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary" data-toggle="tooltip" data-placement="left" title="Toggle secondary sidebar">
            <span class="fa-solid fa-list"></span>
        </label>
    </div>
</div>
            </div>
            
            

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hello, Alpaca?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Hello, Alpaca?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alpaca">
   Alpacaë¥¼ ì™œ ë§Œë“¤ì—ˆì„ê¹Œ?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   í•™ìŠµ ë°©ë²•
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     ë°ì´í„° ìƒì„± ì˜ˆì‹œ
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       í•œêµ­ì–´ ê²°ê³¼
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       ì˜ì–´ ê²°ê³¼
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#prompt">
       prompt
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#hf-fsdp">
       HFë¡œ í•™ìŠµ ë° FSDP ì‚¬ìš©
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#assets-released">
   Assets released
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data">
     ê³µê°œëœ Data ì˜ˆì‹œ
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     ë§ˆì¹˜ë©°
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     ì°¸ê³ ìë£Œ
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>

            <article class="bd-article" role="main">
              
  <p><a class="reference external" href="https://crfm.stanford.edu/2023/03/13/alpaca.html">Alpaca: A Strong, Replicable Instruction-Following Model</a></p>
<section id="hello-alpaca">
<h1>Hello, Alpaca?<a class="headerlink" href="#hello-alpaca" title="Permalink to this heading">#</a></h1>
<p>ìµœê·¼ LLaMaì´ì–´ì„œ ì•„ì£¼ í•«í•œ ëª¨ë¸ì´ ìˆìŠµë‹ˆë‹¤. ë°”ë¡œ Alpacaë¼ëŠ” ëª¨ë¸ì¸ë°ìš”. ì˜¤ëŠ˜ì€ Stanfordì—ì„œ ê³µê°œí•œ ì˜¤í”ˆì†ŒìŠ¤ì¸ Alpacaì— ëŒ€í•´ì„œ ê°„ë‹¨íˆ ì†Œê°œí•´ë³´ë ¤í•©ë‹ˆë‹¤.
Metaì—ì„œ ê³µê°œí•œ LLaMaë¼ëŠ” ì–¸ì–´ëª¨ë¸ì„ Stanford ë°•ì‚¬ê³¼ì • í•™ìƒë“¤ì´ ì‚¬ìš©ìì˜ ëª…ë ¹ì–´ì— ì–¸ì–´ëª¨ë¸ì´ ì˜ ë‹µë³€í•  ìˆ˜ ìˆë„ë¡ Instruction-following ë°ì´í„°ë¡œ íŒŒì¸íŠœë‹í•œ ëª¨ë¸ì…ë‹ˆë‹¤.
ì–¸ì–´ëª¨ë¸ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ìŒ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë¬¸ì œë¥¼ í’€ê¸° ë•Œë¬¸ì— ì¼ë°˜ì ì¸ ì‚¬ìš©ìì˜ ëª…ë ¹ì–´ì— ìì—°ìŠ¤ëŸ½ê²Œ ë‹µë³€í•˜ê¸°ê°€ ì–´ë ¤ìš´ë°ìš”. ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³  ChatGPT ê°™ì€ ëª¨ë¸ì´ ë‹µë³€ì„ ì˜í•˜ëŠ” ê²ƒì€ ì‚¬ìš©ìì˜ ì˜ë„ì— ë§ê²Œ ëª¨ë¸ì„ Instruction-following ë°ì´í„°ë¡œ íŠœë‹ (Alignment) í–ˆê¸° ë•Œë¬¸ì´ë¼ê³ ë„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²°êµ­ ì‚¬ìš©ìê°€ ì–¸ì–´ëª¨ë¸ì„ ì˜ í™œìš©í•˜ê¸° ìœ„í•´ì„œëŠ” Instruction tuningì€ ê¼­ ê±°ì³ì•¼í•˜ëŠ” ê´€ë¬¸ì´ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
LLaMaë¥¼ íŠœë‹í•œ ëª¨ë¸ì´ë‹ˆ ì•„ë§ˆ ë¼ë§ˆì™€ ë¹„ìŠ·í•œ ìƒê¹€ìƒˆ ê°€ì§„ ì•ŒíŒŒì¹´ë¼ê³  ì´ë¦„ì„ ì§€ì€ê²Œ ì•„ë‹Œê°€ ì‹¶ë„¤ìš”ğŸ¤”</p>
<p><img alt="image.png" src="https://devocean.sk.com/editorImg/2023/3/23/e61a09ac00cbff86421a28127c228355177ca171f85f2757aee6d21df3c5fdbd" /></p>
<p>AlpacaëŠ” ë…¼ë¬¸ì´ ë”°ë¡œ ë°œí‘œë˜ì§„ ì•Šì•˜ì§€ë§Œ, ì–´ë–¤ ë°ì´í„°ë¡œ ì–´ë–»ê²Œ í•™ìŠµì„ í–ˆëŠ”ì§€ ì½”ë“œì™€ í•¨ê»˜ ê³µê°œê°€ ë˜ì–´ìˆì–´ì„œ í˜„ì¬ì‹œì ì—ì„œë„ LLaMaì™€ ê°™ì´ ë§ì€ ë³€í˜• ë° ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ë‚˜ì˜¤ê³  ìˆëŠ”ë°ìš”. ì§€ê¸ˆë¶€í„° í•œë²ˆ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
</section>
<section id="alpaca">
<h1>Alpacaë¥¼ ì™œ ë§Œë“¤ì—ˆì„ê¹Œ?<a class="headerlink" href="#alpaca" title="Permalink to this heading">#</a></h1>
<p>Stanford í•™ìƒë“¤ì€ ChatGPT, Claude, Bing Chatë“± ë‹¤ì–‘í•œ ëª¨ë¸ì´ ì´ë¯¸ í›Œë¥­í•œ ì„±ëŠ¥ì„ ë³´ì—¬ì£¼ê³  ìˆì§€ë§Œ ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³  ì•„ì§ì€ ë¶€ì¡±í•œ ì ì´ ìˆë‹¤ê³  ì§€ì í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ë©´, ì˜ëª»ëœ ì •ë³´ë¥¼ ìƒì„±í•˜ê±°ë‚˜, ì‚¬íšŒì ì¸ í¸ê²¬ ë° ë¶ˆí¸í•œ ë§ë“¤ì„ ìƒì„±í•˜ëŠ” ê²ƒì´ì£ . ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ í•™ê³„ì™€ì˜ í˜‘ì—…ì´ í•„ìš”í•˜ì§€ë§Œ OpenAIì˜ <code class="docutils literal notranslate"><span class="pre">text-davinci-003</span></code>ê³¼ ê°™ì€ ëª¨ë¸ì€ ì ‘ê·¼í•˜ê¸° í˜ë“  closed-source modelì´ê¸° ë•Œë¬¸ì— ì—°êµ¬ì— ì–´ë ¤ì›€ì´ ìˆë‹¤ê³  ë§í•©ë‹ˆë‹¤ğŸ¥²
ë§ˆì¹¨ Metaì—ì„œ LLaMaë¥¼ ê³µê°œí–ˆê³ , ê¸°ì¡´ì— ì•Œë ¤ì§„ ì—°êµ¬ë¥¼ ë°”íƒ•ìœ¼ë¡œ í›¨ì”¬ ì €ë ´í•œ ë¹„ìš©ìœ¼ë¡œ ëª¨ë¸ì„ í•™ìŠµí•  ìˆ˜ ìˆë„ë¡, ë°ì´í„° ë° ëª¨ë¸ í•™ìŠµ ë°©ë²•ì„ ì¬í˜„ ê°€ëŠ¥í•˜ë„ë¡ ê³µê°œí•œ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.
ê²°ê³¼ì ìœ¼ë¡œ, AlpacaëŠ” text-davinci-003(175B)ë³´ë‹¤ í›¨ì”¬ ì‘ì€ 7B ëª¨ë¸ì´ì§€ë§Œ ìœ ì‚¬í•˜ê²Œ ë™ì‘í•œë‹¤ê³  í•©ë‹ˆë‹¤.
<a class="reference external" href="https://alpaca-ai.ngrok.io/">Gradio ê¸°ë°˜ ë°ëª¨ í˜ì´ì§€</a>ë„ ê³µê°œí–ˆëŠ”ë°, ì ‘ì†ì€ ê°€ë” ì•ˆë˜ëŠ” ê²ƒ ê°™ë„¤ìš”ğŸ¤”
<img alt="image.png" src="https://devocean.sk.com/editorImg/2023/3/23/c0b4da8b95c774dfc242df286f8ddde97cb4aef73ed9ade7233f3d6d1d3fe741" />
AlpacaëŠ” academic researchì— í•œí•´ì„œë§Œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ê³  ìƒì—…ì  ì‚¬ìš©ì€ ê¸ˆì§€í•˜ê³  ìˆëŠ”ë°ìš”.
ì´ìœ ëŠ” LLaMaì˜ ë¼ì´ì„¼ìŠ¤ê°€ <a class="reference external" href="https://docs.google.com/forms/d/e/1FAIpQLSfqNECQnMkycAp2jP4Z9TFX0cGR4uf7b_fBxjY_OjhJILlKGA/viewform">non-commercial ë¼ì´ì„¼ìŠ¤</a>ë¼ëŠ”ì  ê·¸ë¦¬ê³  <a class="reference external" href="https://openai.com/policies/terms-of-use">OpenAIì˜ tet-davinci-003ì—ì„œ ì–»ì–´ë‚¸ ë°ì´í„°ë¥¼ í™œìš©í–ˆë‹¤ëŠ” ì </a>ë“±ì„ ì´ìœ ë¡œ ì œì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
</section>
<section id="id1">
<h1>í•™ìŠµ ë°©ë²•<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<p>AlpacaëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 7B í¬ê¸°ì˜ LLaMaë¥¼ Backboneìœ¼ë¡œ ë‘ê³  Instruction tuningì„ í•œ ëª¨ë¸ì…ë‹ˆë‹¤.
ëª¨ë¸ì€ ì´ë¯¸ ê³µê°œë˜ì–´ìˆê¸° ë•Œë¬¸ì— ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ ë°ì´í„°ì¸ë°ìš”. ê¸°ì¡´ì— Instruction-following ë°ì´í„°ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ ë§ì€ ì—°êµ¬ê°€ ìˆì—ˆê³  ì‘ë…„ 12ì›”ì¸ ìµœê·¼ì— ê³µê°œëœ <a class="reference external" href="https://github.com/yizhongw/self-instruct">self-Instruct</a>ë¼ëŠ” ì—°êµ¬ë¥¼ ì°¸ê³ í•´ì„œ ë°ì´í„°ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤.
self-Instructì˜ í•µì‹¬ì€ LLM(Large Language Model)ë¡œ ë°ì´í„°ë¥¼ ìƒì„±í•´ì„œ ê·¸ ë°ì´í„°ë¡œ ë‹¤ì‹œ LLMì„ í•™ìŠµí•œë‹¤ëŠ” ê²ƒì¸ë°ìš”, í•œ ë§ˆë””ë¡œ íŠœë‹ì„ ìœ„í•œ ë°ì´í„°ë„ ëª¨ë¸ì´ ìƒì„±í•˜ëŠ” ìê°€ìˆ˜ê¸‰ ì‹œìŠ¤í…œ(?)ì´ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
Alpacaì—ì„œëŠ” self-Instructì˜ ë°©ë²•ë¡ ì„ ì¡°ê¸ˆ ë‹¨ìˆœí™”í•˜ë˜ ëª¨ë¸ì€ ë” ì¢‹ì€ ëª¨ë¸(<a class="reference external" href="https://platform.openai.com/docs/model-index-for-researchers/models-referred-to-as-gpt-3-5">GPT-3(davinci) -&gt; GPT-3.5(text-davinci-003)</a>)ì„ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤.</p>
<section id="id2">
<h2>ë°ì´í„° ìƒì„± ì˜ˆì‹œ<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>Alpacaì—ì„œ ê³µê°œí•œ ë°©ë²•ëŒ€ë¡œ ë°ì´í„°ê°€ ìƒì„±ë˜ëŠ”ì§€ <a class="reference external" href="https://platform.openai.com/playground">OpenAI playground</a>ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.
ì•„ë˜ ë³´ì´ëŠ” ì˜ˆì‹œì™€ ê°™ì´ ë°ì´í„° ìƒì„±ì´ ì˜ ë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<section id="id3">
<h3>í•œêµ­ì–´ ê²°ê³¼<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p><img alt="alpaca-self-gen-korean" src="https://user-images.githubusercontent.com/7252598/225496927-2df4614a-8e35-4032-b65a-54e898ca61e6.gif" /></p>
</section>
<section id="id4">
<h3>ì˜ì–´ ê²°ê³¼<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p><img alt="alpaca-gen-self-instruct-en" src="https://user-images.githubusercontent.com/7252598/225496953-69f90efb-a20e-4147-bf4a-df623fc33e83.gif" /></p>
<p>ìœ„ì™€ ê°™ì€ ê³¼ì •ì„ ë°˜ë³µí•˜ë©´ì„œ ì‚¬ëŒì´ ì§ì ‘ ë§Œë“  175ê°œì˜ seed ë°ì´í„°ì…‹ì„ ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì•½ 52,000ê°œê¹Œì§€ ì¶”ê°€ ìƒì‚°ì„ í•˜ê³ , ì´ ë°ì´í„°ë¥¼ í•™ìŠµì…‹ìœ¼ë¡œ í™œìš©í–ˆìŠµë‹ˆë‹¤.
<img alt="image.png" src="https://devocean.sk.com/editorImg/2023/3/23/1ea18693744d12a835878563919dca568be6bc15017abc8541cf1e969aca5e0d" />
ë°ì´í„°ì˜ í’ˆì§ˆì´ ë§¤ìš° ë›°ì–´ë‚˜ë‹¤ê³  í•  ìˆ˜ëŠ” ì—†ê² ì§€ë§Œ ëª¨ë¸ì„ Alignmentí•˜ê¸°ì—ëŠ” ì–´ëŠì •ë„ ì¶©ë¶„í•œ ë°ì´í„°ë¥¼ ìƒì„±í•œ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. (52,000ê±´ì˜ ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ”ë°ëŠ” <code class="docutils literal notranslate"><span class="pre">$500</span></code> ì •ë„ì˜ ë¹„ìš©ì´ ë“¤ì—ˆë‹¤ê³  í•©ë‹ˆë‹¤)
self-Instructë¡œ ìƒì„±í•œ ë°ì´í„°ë¡œ A100(80GB) 8ëŒ€ë¡œ Supervised Fintuning(SFT)í•˜ë©´ 3 epochì— 3ì‹œê°„ì •ë„ ì†Œìš”ë˜ë©°, ì¼ë°˜ì ì¸ ëª…ë ¹ì–´ì—ë„ ì˜ ë‹µë³€í•  ìˆ˜ ìˆëŠ” ëª¨ë¸ì´ íƒ„ìƒí•˜ê²Œ ë©ë‹ˆë‹¤. (ì´ë•Œ ë°œìƒí•œ ë¹„ìš©ì€ $100 ì´í•˜ë¡œ ë“¤ì—ˆë‹¤ê³  í•©ë‹ˆë‹¤)</p>
</section>
<section id="prompt">
<h3>prompt<a class="headerlink" href="#prompt" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>requirement í…œí”Œë¦¿ì—ë‹¤ê°€ seed_task ì…ë ¥í•´ë†“ìŒ defaultëŠ” 3ê°œ!</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">encode_prompt</span><span class="p">(</span><span class="n">prompt_instructions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Encode multiple prompt instructions into a single string.&quot;&quot;&quot;</span>
    <span class="n">prompt</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./prompt.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">task_dict</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prompt_instructions</span><span class="p">):</span>
        <span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span> <span class="o">=</span> <span class="n">task_dict</span><span class="p">[</span><span class="s2">&quot;instruction&quot;</span><span class="p">],</span> <span class="n">task_dict</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">],</span> <span class="n">task_dict</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]</span>
        <span class="n">instruction</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">instruction</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="nb">input</span> <span class="o">=</span> <span class="s2">&quot;&lt;noinput&gt;&quot;</span> <span class="k">if</span> <span class="nb">input</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="nb">input</span>
        <span class="n">prompt</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;###</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">prompt</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">. Instruction: </span><span class="si">{</span><span class="n">instruction</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">prompt</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">. Input:</span><span class="se">\n</span><span class="si">{</span><span class="nb">input</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">prompt</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">. Output:</span><span class="se">\n</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">prompt</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;###</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">prompt</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">. Instruction:&quot;</span>
    <span class="k">return</span> <span class="n">prompt</span>

<span class="k">def</span> <span class="nf">generate_instruction_following_data</span><span class="p">(</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;./&quot;</span><span class="p">,</span>
    <span class="n">seed_tasks_path</span><span class="o">=</span><span class="s2">&quot;./seed_tasks.jsonl&quot;</span><span class="p">,</span>
    <span class="n">num_instructions_to_generate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">num_prompt_instructions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">request_batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">top_p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">num_cpus</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">seed_tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">seed_tasks_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)]</span>
    <span class="n">seed_instruction_data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;instruction&quot;</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;instruction&quot;</span><span class="p">],</span> <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;instances&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;input&quot;</span><span class="p">],</span> <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;instances&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;output&quot;</span><span class="p">]}</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">seed_tasks</span>
    <span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">seed_instruction_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> human-written seed instructions&quot;</span><span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">request_idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># load the LM-generated instructions</span>
    <span class="n">machine_instruction_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;regen.json&quot;</span><span class="p">)):</span>
        <span class="n">machine_instruction_data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">jload</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;regen.json&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">machine_instruction_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> machine-generated instructions&quot;</span><span class="p">)</span>

    <span class="c1"># similarities = {}</span>
    <span class="n">scorer</span> <span class="o">=</span> <span class="n">rouge_scorer</span><span class="o">.</span><span class="n">RougeScorer</span><span class="p">([</span><span class="s2">&quot;rougeL&quot;</span><span class="p">],</span> <span class="n">use_stemmer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># now let&#39;s generate new instructions!</span>
    <span class="n">progress_bar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">num_instructions_to_generate</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">machine_instruction_data</span><span class="p">:</span>
        <span class="n">progress_bar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">machine_instruction_data</span><span class="p">))</span>

    <span class="c1"># first we tokenize all the seed instructions and generated machine instructions</span>
    <span class="n">all_instructions</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;instruction&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">seed_instruction_data</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;instruction&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">machine_instruction_data</span>
    <span class="p">]</span>
    <span class="n">all_instruction_tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">scorer</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">all_instructions</span><span class="p">]</span>

    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">machine_instruction_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_instructions_to_generate</span><span class="p">:</span>
        <span class="n">request_idx</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">batch_inputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">request_batch_size</span><span class="p">):</span>
            <span class="c1"># only sampling from the seed tasks</span>
            <span class="n">prompt_instructions</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">seed_instruction_data</span><span class="p">,</span> <span class="n">num_prompt_instructions</span><span class="p">)</span>
            <span class="n">prompt</span> <span class="o">=</span> <span class="n">encode_prompt</span><span class="p">(</span><span class="n">prompt_instructions</span><span class="p">)</span>
            <span class="n">batch_inputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
        <span class="n">decoding_args</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">OpenAIDecodingArguments</span><span class="p">(</span>
            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
            <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">max_tokens</span><span class="o">=</span><span class="mi">3072</span><span class="p">,</span>  <span class="c1"># hard-code to maximize the length. the requests will be automatically adjusted</span>
            <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span>
            <span class="n">stop</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">20&quot;</span><span class="p">,</span> <span class="s2">&quot;20.&quot;</span><span class="p">,</span> <span class="s2">&quot;20.&quot;</span><span class="p">],</span>
        <span class="p">)</span>

</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">20</span><span class="n">ê°œì˜</span> <span class="n">ë‹¤ì–‘í•œ</span> <span class="n">task</span> <span class="n">instruction</span> <span class="n">ì„¸íŠ¸ë¥¼</span> <span class="n">ì‘ì„±í•˜ë¼ëŠ”</span> <span class="n">ìš”ì²­ì„</span> <span class="n">ë°›ìŠµë‹ˆë‹¤</span><span class="o">.</span> <span class="n">ì´ëŸ¬í•œ</span> <span class="n">task</span> <span class="n">instructionì€</span> <span class="n">GPT</span> <span class="n">ëª¨ë¸ì—</span> <span class="n">ì œê³µë˜ë©°</span> <span class="n">instructionì„</span> <span class="n">ì™„ë£Œí•˜ê¸°</span> <span class="n">ìœ„í•´</span> <span class="n">GPT</span> <span class="n">ëª¨ë¸ì„</span> <span class="n">í‰ê°€í•©ë‹ˆë‹¤</span><span class="o">.</span>

<span class="n">ìš”êµ¬</span> <span class="n">ì‚¬í•­ì€</span> <span class="n">ë‹¤ìŒê³¼</span> <span class="n">ê°™ìŠµë‹ˆë‹¤</span><span class="o">.</span>
<span class="mf">1.</span> <span class="n">ë‹¤ì–‘ì„±ì„</span> <span class="n">ê·¹ëŒ€í™”í•˜ê¸°</span> <span class="n">ìœ„í•´</span> <span class="n">ê°</span> <span class="n">instructionì—</span> <span class="n">ëŒ€í•´</span> <span class="n">ë™ì‚¬ë¥¼</span> <span class="n">ë°˜ë³µí•˜ì§€</span> <span class="n">ë§ˆì‹­ì‹œì˜¤</span><span class="o">.</span>
<span class="mf">2.</span> <span class="n">instructionì—</span> <span class="n">ì‚¬ìš©ë˜ëŠ”</span> <span class="n">ì–¸ì–´ë„</span> <span class="n">ë‹¤ì–‘í•´ì•¼</span> <span class="n">í•©ë‹ˆë‹¤</span><span class="o">.</span> <span class="n">ì˜ˆë¥¼</span> <span class="n">ë“¤ì–´</span><span class="p">,</span> <span class="n">ëª…ë ¹í˜•</span> <span class="n">instructionê³¼</span> <span class="n">ì§ˆë¬¸ì„</span> <span class="n">ê²°í•©í•´ì•¼</span> <span class="n">í•©ë‹ˆë‹¤</span><span class="o">.</span>
<span class="mf">3.</span> <span class="n">instructionì˜</span> <span class="n">ì¢…ë¥˜ê°€</span> <span class="n">ë‹¤ì–‘í•´ì•¼</span> <span class="n">í•œë‹¤</span><span class="o">.</span> <span class="n">ëª©ë¡ì—ëŠ”</span> <span class="nb">open</span><span class="o">-</span><span class="n">ended</span> <span class="n">ìƒì„±</span><span class="p">,</span> <span class="n">ë¶„ë¥˜</span><span class="p">,</span> <span class="n">í¸ì§‘</span> <span class="n">ë“±ê³¼</span> <span class="n">ê°™ì€</span> <span class="n">ë‹¤ì–‘í•œ</span> <span class="n">ìœ í˜•ì˜</span> <span class="n">ì‘ì—…ì´</span> <span class="n">í¬í•¨ë˜ì–´ì•¼</span> <span class="n">í•©ë‹ˆë‹¤</span><span class="o">.</span>
<span class="mf">2.</span> <span class="n">GPT</span> <span class="n">ì–¸ì–´</span> <span class="n">ëª¨ë¸ì€</span> <span class="n">instructionì„</span> <span class="n">ì™„ë£Œí• </span> <span class="n">ìˆ˜</span> <span class="n">ìˆì–´ì•¼</span> <span class="n">í•©ë‹ˆë‹¤</span><span class="o">.</span> <span class="n">ì˜ˆë¥¼</span> <span class="n">ë“¤ì–´</span> <span class="n">ì–´ì‹œìŠ¤í„´íŠ¸ì—ê²Œ</span> <span class="n">ì‹œê°ì </span><span class="p">,</span> <span class="n">ì‚¬ì§„</span><span class="p">,</span> <span class="n">ì´ë¯¸ì§€</span> <span class="n">ë˜ëŠ”</span> <span class="n">ì˜¤ë””ì˜¤</span> <span class="n">ì¶œë ¥ê³¼</span> <span class="n">ê´€ë ¨ëœ</span> <span class="n">instructionì„</span> <span class="n">ìƒì„±í•˜ì§€</span> <span class="n">ë§ˆì‹­ì‹œìš”</span><span class="o">.</span> <span class="n">ë˜</span> <span class="n">ë‹¤ë¥¸</span> <span class="n">ì˜ˆë¥¼</span> <span class="n">ë“¤ë©´</span> <span class="n">ì–´ì‹œìŠ¤í„´íŠ¸ì—ê²Œ</span> <span class="n">ì˜¤í›„</span> <span class="mi">5</span><span class="n">ì‹œì—</span> <span class="n">ê¹¨ìš°ë¼ê³ </span> <span class="n">ìš”ì²­í•˜ê±°ë‚˜</span> <span class="n">ì–´ë–¤</span> <span class="n">ì‘ì—…ë„</span> <span class="n">ìˆ˜í–‰í• </span> <span class="n">ìˆ˜</span> <span class="n">ì—†ê¸°</span> <span class="n">ë•Œë¬¸ì—</span> <span class="n">ë¯¸ë¦¬</span> <span class="n">ì•Œë¦¼ì„</span> <span class="n">ì„¤ì •í•˜ì§€</span> <span class="n">ë§ˆì‹­ì‹œì˜¤</span><span class="o">.</span>
<span class="mf">3.</span> <span class="n">instructionëŠ”</span> <span class="n">í•œêµ­ì–´ë¡œ</span> <span class="n">ì‘ì„±í•´ì•¼</span> <span class="n">í•©ë‹ˆë‹¤</span><span class="o">.</span>
<span class="mf">4.</span> <span class="n">instructionì€</span> <span class="mi">1</span><span class="o">~</span><span class="mi">2</span><span class="n">ë¬¸ì¥ì´ì–´ì•¼</span> <span class="n">í•©ë‹ˆë‹¤</span><span class="o">.</span> <span class="n">ëª…ë ¹í˜•</span> <span class="n">ë¬¸ì¥ì´ë‚˜</span> <span class="n">ì§ˆë¬¸ì´</span> <span class="n">í—ˆìš©ë©ë‹ˆë‹¤</span><span class="o">.</span>
<span class="mf">5.</span> <span class="n">instructionì—</span> <span class="n">ëŒ€í•œ</span> <span class="n">ì ì ˆí•œ</span> <span class="n">ì…ë ¥ì„</span> <span class="n">ìƒì„±í•´ì•¼</span> <span class="n">í•©ë‹ˆë‹¤</span><span class="o">.</span> <span class="n">ì…ë ¥</span> <span class="n">í•„ë“œì—ëŠ”</span> <span class="n">instructionì—</span> <span class="n">ëŒ€í•´</span> <span class="n">ì œê³µëœ</span> <span class="n">íŠ¹ì •</span> <span class="n">ì˜ˆê°€</span> <span class="n">í¬í•¨ë˜ì–´ì•¼</span> <span class="n">í•©ë‹ˆë‹¤</span><span class="o">.</span> <span class="n">í˜„ì‹¤ì ì¸</span> <span class="n">ë°ì´í„°ë¥¼</span> <span class="n">í¬í•¨í•´ì•¼</span> <span class="n">í•˜ë©°</span> <span class="n">ë‹¨ìˆœí•œ</span> <span class="n">ìë¦¬</span> <span class="n">í‘œì‹œìë¥¼</span> <span class="n">í¬í•¨í•´ì„œëŠ”</span> <span class="n">ì•ˆ</span> <span class="n">ë©ë‹ˆë‹¤</span><span class="o">.</span> <span class="n">ì…ë ¥</span> <span class="n">ë‚´ìš©ì€</span> <span class="n">instructionì„</span> <span class="n">ì–´ë µê²Œ</span> <span class="n">ë§Œë“¤</span> <span class="n">ìˆ˜</span> <span class="n">ìˆëŠ”</span> <span class="n">ì‹¤ì§ˆì ì¸</span> <span class="n">ë‚´ìš©ì„</span> <span class="n">ì œê³µí•´ì•¼</span> <span class="n">í•˜ì§€ë§Œ</span> <span class="n">ì´ìƒì ìœ¼ë¡œëŠ”</span> <span class="mi">100</span><span class="n">ë‹¨ì–´ë¥¼</span> <span class="n">ì´ˆê³¼í•˜ì§€</span> <span class="n">ì•Šì•„ì•¼</span> <span class="n">í•©ë‹ˆë‹¤</span><span class="o">.</span>
<span class="mf">6.</span> <span class="n">ëª¨ë“ </span> <span class="n">instructionì—</span> <span class="n">ì…ë ¥ì´</span> <span class="n">í•„ìš”í•œ</span> <span class="n">ê²ƒì€</span> <span class="n">ì•„ë‹™ë‹ˆë‹¤</span><span class="o">.</span> <span class="n">ì˜ˆë¥¼</span> <span class="n">ë“¤ì–´</span><span class="p">,</span> <span class="n">instructionì´</span> <span class="s2">&quot;ì„¸ê³„ì—ì„œ ê°€ì¥ ë†’ì€ ë´‰ìš°ë¦¬ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?&quot;</span><span class="n">ì™€</span> <span class="n">ê°™ì€</span> <span class="n">ì¼ë°˜ì ì¸</span> <span class="n">ì •ë³´ì—</span> <span class="n">ëŒ€í•´</span> <span class="n">ë¬»ëŠ”</span> <span class="n">ê²½ìš°</span> <span class="n">íŠ¹ì •</span> <span class="n">ì»¨í…ìŠ¤íŠ¸ë¥¼</span> <span class="n">ì œê³µí• </span> <span class="n">í•„ìš”ê°€</span> <span class="n">ì—†ìŠµë‹ˆë‹¤</span><span class="o">.</span> <span class="n">ì´</span> <span class="n">ê²½ìš°</span> <span class="n">ì…ë ¥</span> <span class="n">í•„ë“œì—</span> <span class="s2">&quot;&lt;noinput&gt;&quot;</span><span class="n">ì„</span> <span class="n">ë„£ê¸°ë§Œ</span> <span class="n">í•˜ë©´</span> <span class="n">ë©ë‹ˆë‹¤</span><span class="o">.</span>
<span class="mf">7.</span> <span class="n">ì¶œë ¥ì€</span> <span class="n">instructionê³¼</span> <span class="n">ì…ë ¥ì—</span> <span class="n">ëŒ€í•œ</span> <span class="n">ì ì ˆí•œ</span> <span class="n">ì‘ë‹µì´ì–´ì•¼</span> <span class="n">í•©ë‹ˆë‹¤</span><span class="o">.</span> <span class="n">ì¶œë ¥ì´</span> <span class="mi">100</span><span class="n">ë‹¨ì–´</span> <span class="n">ë¯¸ë§Œì¸ì§€</span> <span class="n">í™•ì¸í•˜ì‹­ì‹œì˜¤</span><span class="o">.</span>

<span class="mi">20</span><span class="n">ê°œ</span> <span class="n">Task</span> <span class="n">instruction</span> <span class="n">ëª©ë¡</span><span class="p">:</span>
</pre></div>
</div>
</section>
<section id="hf-fsdp">
<h3>HFë¡œ í•™ìŠµ ë° FSDP ì‚¬ìš©<a class="headerlink" href="#hf-fsdp" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>python 3.10 ì‚¬ìš©</p></li>
</ul>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>torchrun<span class="w"> </span>--nproc_per_node<span class="o">=</span><span class="m">4</span><span class="w"> </span>--master_port<span class="o">=</span>&lt;your_random_port&gt;<span class="w"> </span>train.py<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--model_name_or_path<span class="w"> </span>&lt;your_path_to_hf_converted_llama_ckpt_and_tokenizer&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--data_path<span class="w"> </span>./alpaca_data.json<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--bf16<span class="w"> </span>True<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output_dir<span class="w"> </span>&lt;your_output_dir&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--num_train_epochs<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--per_device_train_batch_size<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--per_device_eval_batch_size<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--gradient_accumulation_steps<span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--evaluation_strategy<span class="w"> </span><span class="s2">&quot;no&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--save_strategy<span class="w"> </span><span class="s2">&quot;steps&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--save_steps<span class="w"> </span><span class="m">2000</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--save_total_limit<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--learning_rate<span class="w"> </span>2e-5<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--weight_decay<span class="w"> </span><span class="m">0</span>.<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--warmup_ratio<span class="w"> </span><span class="m">0</span>.03<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--lr_scheduler_type<span class="w"> </span><span class="s2">&quot;cosine&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--logging_steps<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fsdp<span class="w"> </span><span class="s2">&quot;full_shard auto_wrap&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fsdp_transformer_layer_cls_to_wrap<span class="w"> </span><span class="s1">&#39;LLaMADecoderLayer&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tf32<span class="w"> </span>True
</pre></div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="assets-released">
<h1>Assets released<a class="headerlink" href="#assets-released" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>Demo: An <a class="reference external" href="https://crfm.stanford.edu/alpaca/">interactive demo</a> for everyone to try out Alpaca.</p></li>
<li><p>Data: <a class="reference external" href="https://github.com/tatsu-lab/stanford_alpaca#data-release">52K demonstrations</a> used to fine-tune Alpaca.</p></li>
<li><p>Data generation process: the code for <a class="reference external" href="https://github.com/tatsu-lab/stanford_alpaca#data-generation-process">generating the data</a>.</p></li>
<li><p>Hyperparameters: for <a class="reference external" href="https://github.com/tatsu-lab/stanford_alpaca#fine-tuning">fine-tuning</a> the model using the Hugging Face API.</p></li>
</ul>
<section id="data">
<h2>ê³µê°œëœ Data ì˜ˆì‹œ<a class="headerlink" href="#data" title="Permalink to this heading">#</a></h2>
<p><img alt="image" src="https://user-images.githubusercontent.com/7252598/225485522-f6c9a03e-2eac-4473-ba66-9d61b22217ff.png" /></p>
<ul class="simple">
<li><p>ëª¨ë¸ ë° í•™ìŠµ ì½”ë“œ ê³µê°œ</p>
<ul>
<li><p>Training code: our code uses the <a class="reference external" href="https://github.com/huggingface/transformers/pull/21955">Hugging Face interface to LLaMA</a>. As of now, the effort to support LLaMA is still ongoing and not stable. We will give the exact training commands once Hugging Face supports LLaMA officially.</p></li>
<li><p><a class="reference external" href="https://github.com/tatsu-lab/stanford_alpaca/blob/61a3b4324505d284200a35dcbf1cc5e438ff2b46/train.py#L133">ì•„ë˜ì—ì„œ IGNORE_INDEX ë¶€ë¶„ì´ ì¤‘ìš”!</a></p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span>
    <span class="n">sources</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">tokenizer</span><span class="p">:</span> <span class="n">transformers</span><span class="o">.</span><span class="n">PreTrainedTokenizer</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Preprocess the data by tokenizing.&quot;&quot;&quot;</span>
    <span class="n">examples</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="o">+</span> <span class="n">t</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">)]</span>
    <span class="n">examples_tokenized</span><span class="p">,</span> <span class="n">sources_tokenized</span> <span class="o">=</span> <span class="p">[</span><span class="n">_tokenize_fn</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">)</span> <span class="k">for</span> <span class="n">strings</span> <span class="ow">in</span> <span class="p">(</span><span class="n">examples</span><span class="p">,</span> <span class="n">sources</span><span class="p">)]</span>
    <span class="n">input_ids</span> <span class="o">=</span> <span class="n">examples_tokenized</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">input_ids</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">source_len</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">sources_tokenized</span><span class="p">[</span><span class="s2">&quot;input_ids_lens&quot;</span><span class="p">]):</span>
        <span class="n">label</span><span class="p">[:</span><span class="n">source_len</span><span class="p">]</span> <span class="o">=</span> <span class="n">IGNORE_INDEX</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">input_ids</span><span class="o">=</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

</pre></div>
</div>
</section>
<section id="id5">
<h2>ë§ˆì¹˜ë©°<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h2>
<p>Stable Diffusionê³¼ ê°™ì´ LLaMaë„ ê³µê°œê°€ ë˜ë©´ì„œ ë‹¤ì–‘í•œ í›„ì† ëª¨ë¸ë“¤ì´ ë¹ ë¥´ê²Œ ë‚˜ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.
ë²Œì¨ 8-bit ì–‘ìí™”ì™€ LoRA(Low-Rank Adaption)ë“±ì„ í™œìš©í•´ì„œ ëŒ€í˜•ì–¸ì–´ëª¨ë¸ì„ ê°œì¸ PCì—ì„œë„ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” í”„ë¡œì íŠ¸ë“¤ì´ ê°œë°œë˜ê³  ìˆê³ , ì´ë¯¸ í•œêµ­ì–´ë¡œ íŠœë‹ëœ <a class="reference external" href="https://github.com/Beomi/KoAlpaca">7B KoAlpaca ëª¨ë¸</a>, <a class="reference external" href="https://huggingface.co/beomi/KoAlpaca-65B-LoRA?fbclid=IwAR3Damgr8gvwhqaSwwoOP-iHC5TepVhf9Gz2rlvpehOcAaplvGHjiH_RrBk">65B ëª¨ë¸</a>ë„ ë“±ì¥í–ˆìŠµë‹ˆë‹¤.
ì•ìœ¼ë¡œëŠ” ì´ì „ë³´ë‹¤ ë” ì €ë ´í•œ ë¹„ìš©ìœ¼ë¡œ ë” ê´œì°®ì€ ì„±ëŠ¥ì˜ ëª¨ë¸ë“¤ì„ ì ì  ë” ë§ì´ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë ê¹Œìš”?
ê°œì„ í•  ë¶€ë¶„ì€ ë§ê² ì§€ë§Œ ì˜¤í”ˆì†ŒìŠ¤ ìƒíƒœê³„ì—ì„œ Alpacaì˜ ë“±ì¥ì€ ê·¸ëŸ¬í•œ ë¯¸ë˜ì— ë¶„ëª… ë„ì›€ì´ ë  ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.
ë¨¼ ë¯¸ë˜ê°€ ì•„ë‹ˆë¼ ì§€ê¸ˆì´ë¼ë„ ì¡°ê¸ˆì€ ë” ë˜‘ë˜‘í•˜ê³  ì¬ë¯¸ìˆëŠ” ìì‹ ë§Œì˜ ì–¸ì–´ëª¨ë¸ì„ ë§Œë“¤ê³  ì‹¶ë‹¤ë©´ ì§€ê¸ˆ <code class="docutils literal notranslate"><span class="pre">Alpaca</span></code>ë¥¼ ì‚¬ìš©í•´ë³´ì‹œëŠ”ê±´ ì–´ë–¨ê¹Œìš”?ğŸ™‚</p>
</section>
<section id="id6">
<h2>ì°¸ê³ ìë£Œ<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://crfm.stanford.edu/2023/03/13/alpaca.html">Alpaca: A Strong, Replicable Instruction-Following Model</a></p></li>
<li><p><a class="reference external" href="https://github.com/tatsu-lab/stanford_alpaca#authors">Alpaca github</a></p></li>
<li><p><a class="reference external" href="https://github.com/Beomi/KoAlpaca">KoAlpaca</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ChatGPT"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

            </article>
            

            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="introduction.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Introduction</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="PEFT.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Introduction</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Hello, Alpaca?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alpaca">
   Alpacaë¥¼ ì™œ ë§Œë“¤ì—ˆì„ê¹Œ?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   í•™ìŠµ ë°©ë²•
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     ë°ì´í„° ìƒì„± ì˜ˆì‹œ
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       í•œêµ­ì–´ ê²°ê³¼
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       ì˜ì–´ ê²°ê³¼
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#prompt">
       prompt
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#hf-fsdp">
       HFë¡œ í•™ìŠµ ë° FSDP ì‚¬ìš©
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#assets-released">
   Assets released
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data">
     ê³µê°œëœ Data ì˜ˆì‹œ
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     ë§ˆì¹˜ë©°
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     ì°¸ê³ ìë£Œ
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By JSYoon
</p>

  </div>
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
Last updated on None.<br>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </div>
        </footer>
        

      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  </body>
</html>